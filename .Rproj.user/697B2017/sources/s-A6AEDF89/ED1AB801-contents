#Begin to load up the core processes for R to use and install in necessary.
#Check if tidyverse is installed
if(!require(tidyverse)){
  #Install tidyverse if it isn't available and load it after
  install.packages("tidyverse")
  library(tidyverse)
}

#Check if shiny is installed
if(!require(shiny)){
  #Install shiny package if it isn't available and load it after
  install.packages("shiny")
  library(shiny)
}

#Check if plotly is installed
if(!require(plotly)){
  #Install plotly if it isn't available and load it after
  install.packages("plotly")
  library(plotly)
}
#if Haven is required, then install and load up the package. 
if (!require(haven)){
  install.packages("haven")
  library(haven)
}

library(ggplot2)
library(Rmisc)

#Setting work area
setwd("C:/Users/regan/OneDrive/University Materials/2019/Summer/INFO281/Final Project/281 Project/Data")

#Begin to initiate data into tidyverse for cleaning.
Ethnic_Data <- read.csv("EthnicData.csv")
female_income<-read.csv("FemaleIncome.csv")
female_Regional<-read.csv("FemaleRegionalData.csv")
Total_Gender_Income<-read.csv("GenderIncomesTotal.csv")
male_income<-read.csv("MaleIncome.csv")
male_regional<-read.csv("MaleRegionalData.csv")
regional_income<-read.csv("RegionalIncome.csv")

#This section is required for the cleaning, sorting and the removal of data that is not used for analysis. 
#Clean unnecessary data from Ethnic Data
Ethnic_Data %>%
  select(-Median.Weekly.Earnings, -Number.of.People, -Median.Hourly.Earnings, -Average.Hourly.Earnings) -> CleanedEthnicData

#Begin to filter out unncessary data in the female income dataset
female_income %>%
  select(-Number.of.People..000., -Median.Weekly.Earnings,- Median.Hourly.Earnings) -> CleanFemaleIncome
CleanFemaleIncome <- gather(CleanFemaleIncome, key ="Average Earnings", value = "Rate of Income", -Year)

#Filter out unnecessary columns in the female regional data
female_Regional %>%
  select(-Median.hourly.earnings, -Number.of.people, -Medain.Weekly.earnings) -> CleanFemalebyRegion
CleanFemalebyRegion <- gather(CleanFemalebyRegion, key = "Measure", value = "Rate of Income", -Year, -Region) 

#Cleaning the Male income data
male_income %>%
  select(-Number.of.People..000., -Median.Weekly.Earnings,-Median.Hourly.Earnings) -> CleanMaleIncome
CleanMaleIncome <- gather(CleanMaleIncome, key = "Measure Rate", value = "Rate of Income", -Year)

#Cleaning the Male Regional incomes data
male_regional %>%
  select(-Median.hourly.earnings, -Medain.Weekly.earnings, -Number.of.people) -> CleanMalebyRegion
CleanMalebyRegion <- gather(CleanMalebyRegion, key = "Income Measure", value = "Rate of Income", -Region, -Year)

#Clean the Overall Regional income data of New Zealand
regional_income %>%
  select(-Number.of.people, -Median.hourly.earnings, -Medain.Weekly.earnings) -> CleanRegionalIncome
CleanRegionalIncome <- gather(CleanRegionalIncome, key = "Income Measure", value = "Rate of Income" , -Year, -Region)

#All data should be cleaned and ready to be processed into ggplot

#Beginning of the generation of visuals for analysis. 
ggplot(data = CleanedEthnicData) + geom_dotplot(mapping = aes(x,y))

